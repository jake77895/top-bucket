<div class="card shadow-sm mb-4">
  <!-- Employee Picture and Name -->
  <div class="card-header bg-light text-black d-flex align-items-center justify-content-between">
    <div class="d-flex align-items-center">
      <%= image_tag(
        employee.picture.present? ? employee.picture.url(:thumb) : 'pictures/blank_profile.png',
        class: 'rounded-circle me-3',
        style: 'width: 50px; height: 50px; object-fit: cover;',
        alt: employee.name
      ) %>
      <div>
        <h5 class="mb-0"><%= employee.name %></h5>
        <div class="d-flex align-items-center">
          <% if employee.employee_verification&.verified_by_admin? %>
            <span class="badge bg-success">Verified By Admin</span>
          <% elsif employee.employee_verification&.user_verifications_count.to_i >= 3 %>
            <span class="badge bg-primary">Verified By Users</span>
          <% else %>
            <span class="badge bg-secondary me-2">Not Yet Verified</span>
            <% if user_signed_in? %>
              <%= link_to edit_user_employee_path(employee, return_to: request.path),
                  class: 'me-2',
                  data: {
                    bs_toggle: 'tooltip',
                    bs_placement: 'top',
                    bs_title: 'Add Or Update Info'
                  } do %>
                <%= image_tag 'icons/edit_icon.svg',
                    alt: 'Edit',
                    style: 'width: 20px; height: 20px;' %>
              <% end %>
              <%= button_to verify_employee_path(employee),
                  method: :post,
                  class: 'btn btn-link p-0 me-2',
                  data: { 
                    confirm: 'Are you sure all the information is correct?',
                    bs_toggle: 'tooltip',
                    bs_placement: 'top',
                    bs_title: 'Everything Correct?'
                  } do %>
                <%= image_tag 'icons/check_square.svg',
                    alt: 'Verify',
                    style: 'width: 20px; height: 20px;' %>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
    <% if employee.linkedin_url.present? %>
      <%= link_to employee.linkedin_url, target: '_blank', rel: 'noopener', class: 'ms-auto' do %>
        <%= image_tag 'external_logos/linkedIn.png', alt: 'LinkedIn', style: 'width: 20px; height: 20px;' %>
      <% end %>
    <% end %>
  </div>

  <!-- Employee Details -->
  <div class="card-body">
    <table class="table table-borderless table-sm mb-0">
      <%# Job Level %>
      <% if employee.job_level %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Level</th>
          <td class="border-bottom"><%= employee.job_level.name %></td>
        </tr>
      <% end %>

      <%# Group %>
      <% if employee.group %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Group</th>
          <td class="border-bottom"><%= employee.group.name %></td>
        </tr>
      <% end %>

      <%# Location %>
      <% if employee.location %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Location</th>
          <td class="border-bottom"><%= employee.location.name %></td>
        </tr>
      <% end %>

      <%# Company %>
      <% if employee.company %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Company</th>
          <td class="border-bottom"><%= employee.company.name %></td>
        </tr>
      <% end %>

      <%# Email %>
      <% if employee.email.present? %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Email</th>
          <td class="border-bottom">
            <%= employee.email %>
            <% if employee.email_used? %>
              <span class="badge rounded-pill bg-primary ms-2">Used</span>
            <% end %>
          </td>
        </tr>
      <% end %>

      <%# Previous Company %>
      <% if employee.previous_company %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Previous Company</th>
          <td class="border-bottom"><%= employee.previous_company.name %></td>
        </tr>
      <% end %>

      <%# Undergraduate School %>
      <% if employee.undergraduate_school %>
        <tr>
          <th scope="row" class="text-nowrap border-bottom">Undergraduate School</th>
          <td class="border-bottom"><%= employee.undergraduate_school.name %></td>
        </tr>
      <% end %>

      <%# Graduate School %>
      <% if employee.graduate_school %>
        <tr>
          <th scope="row" class="text-nowrap">Graduate School</th>
          <td><%= employee.graduate_school.name %></td>
        </tr>
      <% end %>
    </table>
  </div>
</div>
